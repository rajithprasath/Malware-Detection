package sliit.ranjitha.malwaredetector.model;

import android.content.pm.ActivityInfo;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;


import java.util.ArrayList;
import java.util.List;

public class ActivityService {

    public final ActivityDataAggregate get(PackageInfo packageInfo, PackageManager packageManager) {
        List<ActivityData> activityDataList = this.getActivities(packageInfo,packageManager);
        System.out.println("shshshshshshhshshshhs 777777777 " + activityDataList.size());
        return new ActivityDataAggregate(activityDataList);
    }

    private final List<ActivityData> getActivities(PackageInfo packageInfo,PackageManager packageManager) {
        List<ActivityData> activityDataList = new ArrayList<>();
        if(packageInfo.activities == null){
            return activityDataList;
        }
        System.out.println("shshshshshshhshshshhs 8888888888 " + packageInfo.activities.length);

        for (int i = 0; i <packageInfo.activities.length ; i++) {
            ActivityInfo activityInfo = packageInfo.activities[i];
            ActivityData activityData = new ActivityData(activityInfo.name,activityInfo.packageName,activityInfo.loadLabel(packageManager).toString(),activityInfo.targetActivity,activityInfo.permission,activityInfo.parentActivityName,activityInfo.exported);
            activityDataList.add(activityData);
        }
        return activityDataList;
    }

}
